<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<title>Delicias</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400;1,700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#0a0806;
  --surface:#131009;
  --surface2:#1a1610;
  --border:#272018;
  --border2:#332a1a;
  --gold:#c8a45a;
  --gold2:#ddb96a;
  --gold3:#f0d48a;
  --goldsoft:rgba(200,164,90,.12);
  --cream:#f2e8d8;
  --cream2:#d8c9a8;
  --text:#ede4d4;
  --text2:#a89878;
  --text3:#6a5c44;
  --green:#1a6640;
  --red:#8b2020;
  --safe-bottom:env(safe-area-inset-bottom, 20px);
  --safe-top:env(safe-area-inset-top, 0px);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;background:var(--bg);}
body{
  font-family:'Outfit',sans-serif;
  color:var(--text);
  overscroll-behavior-y:none;
}

/* ════ ANIMACIONES OPTIMIZADAS (GPU) ════ */
@keyframes fadeScale {
  from{opacity:0;transform:scale(0.95);}
  to{opacity:1;transform:scale(1);}
}
@keyframes slideUpFade {
  from{opacity:0;transform:translateY(15px);}
  to{opacity:1;transform:translateY(0);}
}
@keyframes shimmer {
  0%{background-position:-200% 0;}
  100%{background-position:200% 0;}
}
@keyframes floatY {
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-6px);}
}
@keyframes steamRise {
  0%{opacity:0;transform:translateY(5px) scale(0.8);}
  50%{opacity:0.8;transform:translateY(-5px) scale(1);}
  100%{opacity:0;transform:translateY(-15px) scale(1.2);}
}
@keyframes pulseDot {
  0%,100%{transform:scale(1);opacity:1;}
  50%{transform:scale(0.8);opacity:0.5;}
}

/* ════ NAVEGACIÓN TIPO APP ════ */
.page{
  position:fixed;inset:0;
  display:flex;flex-direction:column;
  background:var(--bg);
  transform:translateX(100%);
  transition:transform 0.4s cubic-bezier(0.3, 1, 0.3, 1), opacity 0.4s ease;
  will-change:transform, opacity;
  z-index:10;
  opacity:0;
}
.page.active{
  transform:translateX(0);
  opacity:1;
}
.page.behind{
  transform:translateX(-20%);
  opacity:0.6;
  z-index:5;
}

/* ════ HOME MEJORADO MÓVIL ════ */
#page-home{
  z-index:1;
  justify-content:space-between;
  overflow:hidden;
}
.home-bg-glow {
  position:absolute;inset:0;
  background:radial-gradient(circle at 50% 15%, rgba(200,164,90,.15) 0%, transparent 60%);
  pointer-events:none;
}
.home-top{
  flex:1;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  padding:calc(40px + var(--safe-top)) 24px 24px;
  position:relative;
  z-index:2;
}

/* --- LOGO NUEVO: Minimalista y Elegante --- */
.brand-icon{
  width:110px;height:110px;
  margin-bottom:20px;
  position:relative;
  animation:floatY 6s ease-in-out infinite;
  display:flex;align-items:center;justify-content:center;
}
.brand-icon::after {
  content:'';
  position:absolute;
  width:80%; height:20px;
  bottom:-10px;
  background:radial-gradient(ellipse at center, rgba(200,164,90,0.2) 0%, transparent 70%);
  border-radius:50%;
}
.brand-icon svg{
  width:100%;height:100%;
  filter:drop-shadow(0 4px 12px rgba(200,164,90,.3));
}
.steam { opacity:0; }
.steam-1 { animation:steamRise 3s infinite 0.5s; }
.steam-2 { animation:steamRise 3s infinite 2s; }

/* Textos de marca */
.brand-name{
  font-family:'Playfair Display',serif;
  font-size:3.2rem;
  font-weight:900;
  color:var(--gold2);
  letter-spacing:.02em;
  line-height:1;
  margin-bottom:8px;
  background:linear-gradient(135deg, var(--gold) 0%, var(--gold3) 50%, var(--gold) 100%);
  background-size:200% auto;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  animation:shimmer 5s linear infinite;
}
.brand-tagline{
  font-size:.75rem;
  letter-spacing:.4em;
  text-transform:uppercase;
  color:var(--text3);
  font-weight:400;
  margin-bottom:40px;
  animation:slideUpFade 0.8s ease forwards 0.2s;
  opacity:0;
}

/* Botones Móviles */
.home-btns{
  display:flex;flex-direction:column;gap:12px;
  width:100%;max-width:340px;
}
.btn-nav{
  display:flex;align-items:center;gap:16px;
  padding:16px 20px;
  border-radius:18px;
  border:1px solid var(--border2);
  background:var(--surface);
  color:var(--text);
  cursor:pointer;
  font-family:'Outfit',sans-serif;
  text-align:left;
  position:relative;
  overflow:hidden;
  opacity:0;
  transform:translateY(15px);
  transition:background 0.2s, transform 0.1s, border-color 0.2s;
}
.btn-nav:nth-child(1){animation:slideUpFade 0.5s ease forwards 0.3s;}
.btn-nav:nth-child(2){animation:slideUpFade 0.5s ease forwards 0.4s;}
.btn-nav:nth-child(3){animation:slideUpFade 0.5s ease forwards 0.5s;}

.btn-nav:active{
  transform:scale(0.96);
  background:var(--surface2);
  border-color:var(--gold);
}

.btn-nav-icon{
  width:44px;height:44px;
  border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  background:linear-gradient(135deg,var(--goldsoft),rgba(200,164,90,.02));
  color:var(--gold2);
  flex-shrink:0;
}
.btn-nav-icon svg{
  width:22px;height:22px;
  stroke:currentColor;stroke-width:1.5;fill:none;stroke-linecap:round;stroke-linejoin:round;
}
.btn-nav-content{flex:1;}
.btn-nav-title{font-weight:600;font-size:1.05rem;color:var(--cream);}
.btn-nav-sub{font-size:.75rem;color:var(--text3);margin-top:2px;}
.btn-nav-arrow{color:var(--text3);}
.btn-nav-arrow svg{width:20px;height:20px;stroke:currentColor;stroke-width:1.5;fill:none;stroke-linecap:round;stroke-linejoin:round;}

/* WiFi Live Dot */
.wifi-live{
  position:absolute;top:18px;right:18px;
  width:6px;height:6px;
  background:#4ade80;
  border-radius:50%;
  box-shadow:0 0 8px #4ade80;
  animation:pulseDot 2s infinite;
}

.home-footer{
  padding:16px 24px var(--safe-bottom);
  text-align:center;
  z-index:2;
}
.home-footer a{
  font-size:.7rem;letter-spacing:.2em;text-transform:uppercase;
  color:var(--text3);text-decoration:none;
  display:inline-flex;align-items:center;gap:6px;
  padding:10px;
}

/* ════ INNER PAGES ════ */
.page-header{
  display:flex;align-items:center;gap:12px;
  padding:calc(12px + var(--safe-top)) 20px 12px;
  background:rgba(10,8,6,.85);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  border-bottom:1px solid var(--border);
  flex-shrink:0;
  z-index:10;
}
.btn-back{
  width:40px;height:40px;
  border-radius:12px;
  border:1px solid transparent;
  background:var(--surface2);
  color:var(--text2);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  transition:all .2s;
}
.btn-back:active{
  transform:scale(0.9);
  background:var(--goldsoft);
  color:var(--gold);
}
.btn-back svg{
  width:24px;height:24px;stroke:currentColor;stroke-width:2;fill:none;stroke-linecap:round;stroke-linejoin:round;
}
.page-title{font-family:'Playfair Display',serif;font-size:1.25rem;font-weight:700;color:var(--gold2);}
.page-sub{font-size:.7rem;color:var(--text3);letter-spacing:0.05em;}

.page-body{
  flex:1;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  padding-bottom:calc(24px + var(--safe-bottom));
}

/* ════ MENÚ ════ */
.cat-bar{
  display:flex;gap:8px;
  overflow-x:auto;
  padding:12px 20px;
  scrollbar-width:none;
  border-bottom:1px solid var(--border);
}
.cat-bar::-webkit-scrollbar{display:none;}
.cat-chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:8px 16px;
  border-radius:100px;
  border:1px solid var(--border2);
  background:var(--bg);
  font-family:'Outfit',sans-serif;
  font-size:.85rem;font-weight:500;
  color:var(--text2);
  white-space:nowrap;
  transition:all .2s;
}
.cat-chip svg{width:16px;height:16px;stroke:currentColor;stroke-width:1.5;fill:none;stroke-linecap:round;stroke-linejoin:round;}
.cat-chip.active{
  background:var(--goldsoft);
  border-color:var(--gold);
  color:var(--gold2);
}

#menu-body{padding:16px 20px;}
.menu-section-title{
  font-family:'Playfair Display',serif;font-size:1.15rem;font-style:italic;color:var(--cream2);
  margin:10px 0 14px;
  display:flex;align-items:center;gap:10px;
}
.menu-section-title::after{content:'';flex:1;height:1px;background:var(--border2);}
.menu-grid{
  display:grid;grid-template-columns:repeat(auto-fill, minmax(140px, 1fr));gap:12px;margin-bottom:24px;
}
.menu-card{
  background:var(--surface);border:1px solid var(--border);border-radius:16px;
  padding:16px 12px;
  transition:transform 0.1s, border-color 0.2s;
}
.menu-card:active{transform:scale(0.97);border-color:var(--gold);}
.menu-card-ico{
  width:40px;height:40px;border-radius:12px;
  background:var(--surface2);color:var(--gold2);
  display:flex;align-items:center;justify-content:center;margin-bottom:12px;
}
.menu-card-ico svg{width:20px;height:20px;stroke:currentColor;stroke-width:1.5;fill:none;stroke-linecap:round;stroke-linejoin:round;}
.menu-card-name{font-size:.9rem;font-weight:600;color:var(--text);line-height:1.2;margin-bottom:4px;}
.menu-card-cat{font-size:.65rem;color:var(--text3);text-transform:uppercase;letter-spacing:.05em;margin-bottom:10px;}
.menu-card-price{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;color:var(--gold);}

/* ════ PEDIDO ════ */
#page-pedido .page-body{padding:20px;}
.mesa-card{
  background:var(--surface);border:1px solid var(--border);border-radius:20px;
  padding:24px 20px;margin-bottom:16px;text-align:center;
}
.mesa-card-label{font-size:.7rem;letter-spacing:.2em;text-transform:uppercase;color:var(--text3);margin-bottom:12px;}
.mesa-input-row{display:flex;gap:10px;max-width:280px;margin:0 auto;}
.mesa-input{
  flex:1;padding:12px;border:2px solid var(--border2);border-radius:14px;
  background:var(--bg);color:var(--text);font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;text-align:center;
  -webkit-appearance:none;
}
.mesa-input:focus{outline:none;border-color:var(--gold);}
.btn-buscar{
  padding:0 20px;background:linear-gradient(135deg,var(--gold),var(--gold2));
  border:none;border-radius:14px;color:#0a0806;font-family:'Outfit',sans-serif;font-weight:700;font-size:1rem;
  display:flex;align-items:center;gap:6px;transition:transform 0.1s;
}
.btn-buscar:active{transform:scale(0.95);}
.btn-buscar svg{width:20px;height:20px;stroke:currentColor;stroke-width:2;fill:none;stroke-linecap:round;stroke-linejoin:round;}

#pedido-result{display:none;}
#pedido-result.show{display:block;animation:slideUpFade 0.4s ease;}
.result-header{
  background:var(--surface2);border:1px solid var(--border);border-radius:16px 16px 0 0;
  padding:16px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:none;
}
.result-mesa{font-family:'Playfair Display',serif;font-size:2rem;font-weight:900;color:var(--gold2);}
.result-mesa-lbl{font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--text3);}
.badge-activo{
  display:inline-flex;align-items:center;gap:6px;background:rgba(74,222,128,.15);border-radius:100px;
  padding:6px 12px;font-size:.75rem;font-weight:600;color:#4ade80;
}
.badge-dot{width:6px;height:6px;border-radius:50%;background:#4ade80;animation:pulseDot 1.5s infinite;}

.result-items{background:var(--surface);border:1px solid var(--border);border-top:none;border-radius:0 0 16px 16px;}
.result-item{
  padding:14px 20px;display:grid;grid-template-columns:1fr auto auto;gap:12px;align-items:center;
  border-bottom:1px solid var(--border);
}
.result-item-name{font-size:.9rem;font-weight:500;}
.result-item-qty{
  background:var(--surface2);border-radius:8px;padding:4px 12px;
  font-family:'Playfair Display',serif;font-size:1rem;color:var(--gold2);font-weight:700;
}
.result-item-sub{font-size:.9rem;font-weight:600;color:var(--text2);font-family:'Playfair Display',serif;}
.result-total{
  background:var(--surface2);padding:16px 20px;display:flex;justify-content:space-between;align-items:center;
}
.result-total-lbl{font-size:.7rem;letter-spacing:.1em;text-transform:uppercase;color:var(--text3);}
.result-total-amt{font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:900;color:var(--gold);}

/* ════ MODAL WIFI ════ */
.modal-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);
  display:none;align-items:flex-end;z-index:100;opacity:0;transition:opacity .3s;
}
.modal-overlay.open{display:flex;opacity:1;}
.modal-sheet{
  background:var(--surface);border-radius:24px 24px 0 0;width:100%;
  padding:0 0 calc(24px + var(--safe-bottom));
  transform:translateY(100%);transition:transform .4s cubic-bezier(.3,1,.3,1);
}
.modal-overlay.open .modal-sheet{transform:translateY(0);}
.modal-drag{width:40px;height:4px;background:var(--border2);border-radius:2px;margin:12px auto 20px;}
.modal-head{padding:0 24px 16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);}
.modal-title{font-family:'Playfair Display',serif;font-size:1.2rem;color:var(--gold2);display:flex;align-items:center;gap:10px;}
.modal-title svg{width:22px;height:22px;stroke:currentColor;fill:none;stroke-width:1.5;}
.modal-close-btn{
  width:36px;height:36px;border-radius:10px;background:var(--surface2);color:var(--text2);
  border:none;display:flex;align-items:center;justify-content:center;
}
.modal-close-btn:active{transform:scale(0.9);}
.modal-close-btn svg{width:18px;height:18px;stroke:currentColor;stroke-width:2;}
.modal-body{padding:20px 24px 0;}
.wifi-row{background:var(--bg);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:12px;}
.wifi-row-label{font-size:.7rem;letter-spacing:.15em;text-transform:uppercase;color:var(--text3);margin-bottom:4px;}
.wifi-row-value{font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;color:var(--cream);}
.btn-copy-pass{
  width:100%;padding:16px;background:linear-gradient(135deg,var(--gold),var(--gold2));border:none;border-radius:14px;
  color:#0a0806;font-family:'Outfit',sans-serif;font-weight:700;font-size:1rem;display:flex;align-items:center;justify-content:center;gap:8px;
  margin-top:20px;transition:transform 0.1s;
}
.btn-copy-pass:active{transform:scale(0.96);}
.btn-copy-pass svg{width:20px;height:20px;stroke:currentColor;stroke-width:2;fill:none;}

/* ════ TOAST ════ */
.toast{
  position:fixed;bottom:calc(20px + var(--safe-bottom));left:50%;transform:translate(-50%, 20px);
  background:var(--surface2);border:1px solid var(--gold);color:var(--gold3);
  padding:12px 24px;border-radius:100px;font-size:.9rem;font-weight:500;z-index:999;
  opacity:0;transition:all 0.3s;pointer-events:none;
}
.toast.show{opacity:1;transform:translate(-50%, 0);}
</style>
</head>
<body>

<div id="page-home" class="page active">
  <div class="home-bg-glow"></div>
  <div class="home-top">
    
    <div class="brand-icon">
      <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gold" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#f0d48a"/>
            <stop offset="50%" stop-color="#ddb96a"/>
            <stop offset="100%" stop-color="#c8a45a"/>
          </linearGradient>
        </defs>
        <path d="M75 25 L76 30 L81 31 L76 32 L75 37 L74 32 L69 31 L74 30 Z" fill="url(#gold)"/>
        <path d="M25 35 L25.5 38 L28.5 38.5 L25.5 39 L25 42 L24.5 39 L21.5 38.5 L24.5 38 Z" fill="url(#gold)"/>
        <path d="M42 30 Q35 20 48 10" stroke="url(#gold)" stroke-width="2" stroke-linecap="round" class="steam steam-1"/>
        <path d="M58 35 Q65 25 52 15" stroke="url(#gold)" stroke-width="2" stroke-linecap="round" class="steam steam-2"/>
        <path d="M15 70 L85 70" stroke="url(#gold)" stroke-width="4" stroke-linecap="round"/>
        <path d="M25 70 C 25 40, 75 40, 75 70" stroke="url(#gold)" stroke-width="3" fill="rgba(200,164,90,0.08)"/>
        <circle cx="50" cy="38" r="5" fill="url(#gold)"/>
        <path d="M48 38 L52 38" stroke="#131009" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </div>

    <div class="brand-name">Delicias</div>
    <div class="brand-tagline">Restaurante</div>

    <div class="home-btns">
      <button class="btn-nav" onclick="irA('menu')">
        <div class="btn-nav-icon"><svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/><path d="M8 7h8"/><path d="M8 11h5"/></svg></div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">Ver Menú</div>
          <div class="btn-nav-sub">Platos, bebidas y postres</div>
        </div>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>

      <button class="btn-nav" onclick="irA('pedido')">
        <div class="btn-nav-icon"><svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">Mi Pedido</div>
          <div class="btn-nav-sub">Ver cuenta en tiempo real</div>
        </div>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>

      <button class="btn-nav" onclick="abrirWifi()">
        <div class="btn-nav-icon"><svg viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1" fill="currentColor" stroke="none"/></svg></div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">WiFi Gratis</div>
          <div class="btn-nav-sub" id="wifi-sub-txt">Red disponible</div>
        </div>
        <span class="wifi-live"></span>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>
    </div>
  </div>

  <div class="home-footer">
    <a href="admin.html">Acceso de Personal <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" fill="none" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg></a>
  </div>
</div>

<div id="page-menu" class="page">
  <div class="page-header">
    <button class="btn-back" onclick="irAtras()"><svg viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg></button>
    <div>
      <div class="page-title">Nuestro Menú</div>
      <div class="page-sub" id="menu-sub">Cargando...</div>
    </div>
  </div>
  <div class="cat-bar">
    <button class="cat-chip active" data-cat="todos" onclick="filtrarCat('todos',this)">Todos</button>
    <button class="cat-chip" data-cat="comida" onclick="filtrarCat('comida',this)">Comidas</button>
    <button class="cat-chip" data-cat="bebida" onclick="filtrarCat('bebida',this)">Bebidas</button>
    <button class="cat-chip" data-cat="postre" onclick="filtrarCat('postre',this)">Postres</button>
  </div>
  <div class="page-body"><div id="menu-body"></div></div>
</div>

<div id="page-pedido" class="page">
  <div class="page-header">
    <button class="btn-back" onclick="irAtras()"><svg viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg></button>
    <div>
      <div class="page-title">Mi Pedido</div>
      <div class="page-sub">Consulta tu mesa</div>
    </div>
  </div>
  <div class="page-body">
    <div class="mesa-card">
      <div class="mesa-card-label">Número de mesa</div>
      <div class="mesa-input-row">
        <input class="mesa-input" type="number" id="inp-mesa" min="1" max="12" placeholder="—" inputmode="numeric"/>
        <button class="btn-buscar" onclick="buscarPedido()"><svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></button>
      </div>
    </div>
    <div id="pedido-result"></div>
  </div>
</div>

<div class="modal-overlay" id="modal-wifi" onclick="if(event.target===this)cerrarWifi()">
  <div class="modal-sheet">
    <div class="modal-drag"></div>
    <div class="modal-head">
      <div class="modal-title"><svg viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1" fill="currentColor" stroke="none"/></svg> WiFi Gratis</div>
      <button class="modal-close-btn" onclick="cerrarWifi()"><svg viewBox="0 0 24 24"><path d="M18 6 6 18m0-12 12 12"/></svg></button>
    </div>
    <div class="modal-body">
      <div class="wifi-row"><div class="wifi-row-label">Red (SSID)</div><div class="wifi-row-value" id="wifi-ssid">—</div></div>
      <div class="wifi-row"><div class="wifi-row-label">Contraseña</div><div class="wifi-row-value" id="wifi-pass">—</div></div>
      <button class="btn-copy-pass" onclick="copiarPass()"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copiar Contraseña</button>
    </div>
  </div>
</div>

<div class="toast" id="toast-msg"></div>

<script type="module">
import { initializeApp }  from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const FC = {
  apiKey:"AIzaSyCdKSf2g1cIyXrD6k_u1aR9TMln9HaPJro",
  authDomain:"delicia-restaurante.firebaseapp.com",
  databaseURL:"https://delicia-restaurante-default-rtdb.firebaseio.com",
  projectId:"delicia-restaurante"
};
const app = initializeApp(FC);
const db = getDatabase(app);

const FMT = n => 'Gs. ' + Math.round(n).toLocaleString('es-PY');
const $ = id => document.getElementById(id);

/* --- NUEVO: Función de Vibración Háptica --- */
function haptic() {
  if (navigator.vibrate) navigator.vibrate(40);
}

/* --- Lógica de Navegación --- */
let pageStack = [];
window.irA = function(pageId) {
  haptic();
  const cur = pageStack.length ? $('page-' + pageStack[pageStack.length-1]) : $('page-home');
  cur.classList.add('behind'); cur.classList.remove('active');
  pageStack.push(pageId);
  const next = $('page-' + pageId);
  next.classList.add('active'); next.classList.remove('behind');
};

window.irAtras = function() {
  if (!pageStack.length) return;
  haptic();
  const cur = $('page-' + pageStack.pop());
  cur.classList.remove('active');
  const prev = pageStack.length ? $('page-' + pageStack[pageStack.length-1]) : $('page-home');
  prev.classList.remove('behind'); prev.classList.add('active');
};

/* --- NUEVO: Swipe para volver atrás (Gestos nativos) --- */
let touchStartX = 0;
document.addEventListener('touchstart', e => {
  touchStartX = e.changedTouches[0].screenX;
}, {passive: true});
document.addEventListener('touchend', e => {
  const touchEndX = e.changedTouches[0].screenX;
  if (touchEndX - touchStartX > 100 && pageStack.length > 0) { // Si desliza más de 100px a la derecha
    irAtras();
  }
}, {passive: true});

/* --- Lógica WiFi --- */
window.abrirWifi = () => { haptic(); $('modal-wifi').classList.add('open'); };
window.cerrarWifi = () => { haptic(); $('modal-wifi').classList.remove('open'); };
window.copiarPass = () => {
  haptic();
  const p = $('wifi-pass').textContent;
  navigator.clipboard?.writeText(p).then(() => showToast('Contraseña copiada')).catch(() => showToast('Error al copiar'));
};

function showToast(msg) {
  const t = $('toast-msg');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

/* --- Firebase Dummy Data Management (Mantenido) --- */
let productos = [], mesas = {}, catActiva = 'todos';
onValue(ref(db,'productos'), snap => {
  const r = snap.val();
  productos = r ? (Array.isArray(r) ? r : Object.values(r)).filter(Boolean) : [];
  renderMenuFiltrado();
});
onValue(ref(db,'mesas'), snap => { mesas = snap.val() || {}; });

window.filtrarCat = function(cat, el) {
  haptic();
  catActiva = cat;
  document.querySelectorAll('.cat-chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  renderMenuFiltrado();
};

function renderMenuFiltrado() {
  const body = $('menu-body');
  const items = catActiva === 'todos' ? productos : productos.filter(p => p.cat === catActiva);
  $('menu-sub').textContent = `${productos.length} productos`;
  
  if(!items.length) { body.innerHTML = '<div style="text-align:center;padding:40px;color:var(--text3)">No hay productos</div>'; return; }
  
  body.innerHTML = `<div class="menu-grid">
    ${items.map(p => `
      <div class="menu-card">
        <div class="menu-card-name">${p.nombre}</div>
        <div class="menu-card-price">${FMT(p.precio)}</div>
      </div>`).join('')}
  </div>`;
}

window.buscarPedido = function() {
  haptic();
  const num = parseInt($('inp-mesa').value);
  const res = $('pedido-result');
  if (isNaN(num)) return showToast('Ingresá un número válido');
  
  const mesa = mesas[num];
  if (!mesa || !mesa.ocupada) {
    res.innerHTML = `<div style="text-align:center;padding:40px;color:var(--text3)">Mesa ${num} libre o sin pedidos</div>`;
  } else {
    // Renderizado simple simulado
    res.innerHTML = `
      <div class="result-header">
        <div><div class="result-mesa-lbl">Mesa</div><div class="result-mesa">${num}</div></div>
        <div class="badge-activo"><span class="badge-dot"></span>Activa</div>
      </div>
      <div class="result-items">
        <div class="result-total">
          <span class="result-total-lbl">Total estimado</span>
          <span class="result-total-amt">Gs. ...</span>
        </div>
      </div>`;
  }
  res.classList.add('show');
};
</script>
</body>
</html>
