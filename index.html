<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<title>Delicias</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400;1,700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#0a0806;
  --surface:#131009;
  --surface2:#1a1610;
  --border:#272018;
  --border2:#332a1a;
  --gold:#c8a45a;
  --gold2:#ddb96a;
  --gold3:#f0d48a;
  --goldsoft:rgba(200,164,90,.12);
  --cream:#f2e8d8;
  --cream2:#d8c9a8;
  --text:#ede4d4;
  --text2:#a89878;
  --text3:#6a5c44;
  --green:#1a6640;
  --red:#8b2020;
  --safe-bottom:env(safe-area-inset-bottom,0px);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;}
body{
  font-family:'Outfit',sans-serif;
  background:var(--bg);
  color:var(--text);
  overscroll-behavior:none;
}

/* ════ ANIMACIONES KEYFRAMES ════ */
@keyframes float{
  0%,100%{transform:translateY(0px) rotate(0deg);}
  50%{transform:translateY(-8px) rotate(1deg);}
}
@keyframes glowPulse{
  0%,100%{filter:drop-shadow(0 0 20px rgba(200,164,90,.4)) brightness(1);}
  50%{filter:drop-shadow(0 0 40px rgba(200,164,90,.8)) brightness(1.2);}
}
@keyframes shimmer{
  0%{background-position:-200% 0;}
  100%{background-position:200% 0;}
}
@keyframes liquidMove{
  0%,100%{d:path("M27 12 Q24 28 30 36 Q34 42 40 43 Q46 42 50 36 Q56 28 53 12 Z");}
  50%{d:path("M27 12 Q25 29 31 37 Q35 43 40 44 Q45 43 49 37 Q55 29 53 12 Z");}
}
@keyframes forkShake{
  0%,100%{transform:translateX(0) rotate(0deg);}
  25%{transform:translateX(-1px) rotate(-2deg);}
  75%{transform:translateX(1px) rotate(2deg);}
}
@keyframes knifeCut{
  0%,100%{transform:translateX(0);}
  50%{transform:translateX(2px);}
}
@keyframes sparkle{
  0%,100%{opacity:0;transform:scale(0) rotate(0deg);}
  50%{opacity:1;transform:scale(1) rotate(180deg);}
}
@keyframes pageEnter{
  from{opacity:0;transform:translateY(20px) scale(0.98);}
  to{opacity:1;transform:translateY(0) scale(1);}
}
@keyframes slideInRight{
  from{opacity:0;transform:translateX(30px);}
  to{opacity:1;transform:translateX(0);}
}
@keyframes fadeScale{
  from{opacity:0;transform:scale(0.9);}
  to{opacity:1;transform:scale(1);}
}
@keyframes borderGlow{
  0%,100%{border-color:var(--border2);}
  50%{border-color:var(--gold);}
}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}

/* ════ PAGES ════ */
.page{
  position:fixed;inset:0;
  display:flex;flex-direction:column;
  background:var(--bg);
  transform:translateX(100%);
  transition:transform .5s cubic-bezier(.4,0,.2,1), opacity .4s ease;
  will-change:transform;
  z-index:10;
  opacity:0;
}
.page.active{
  transform:translateX(0);
  opacity:1;
  animation:pageEnter .6s cubic-bezier(.4,0,.2,1);
}
.page.behind{
  transform:translateX(-12%) scale(.95);
  opacity:.4;
  filter:blur(2px);
  z-index:5;
}

/* ════ HOME ════ */
#page-home{
  transform:translateX(0);
  z-index:1;
  justify-content:space-between;
  overflow:hidden;
}

#page-home::before{
  content:'';
  position:absolute;inset:0;
  background:
    radial-gradient(ellipse 80% 60% at 50% 0%, rgba(200,164,90,.12) 0%, transparent 60%),
    radial-gradient(ellipse 60% 40% at 80% 100%, rgba(200,164,90,.08) 0%, transparent 50%);
  pointer-events:none;
  animation:glowPulse 4s ease-in-out infinite;
}

.home-top{
  flex:1;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  padding:40px 32px 24px;
  position:relative;
}

/* Icono principal mejorado */
.brand-icon{
  width:100px;height:100px;
  margin-bottom:24px;
  position:relative;
  animation:float 6s ease-in-out infinite;
}
.brand-icon::before{
  content:'';
  position:absolute;
  inset:-20px;
  background:radial-gradient(circle, rgba(200,164,90,.2) 0%, transparent 70%);
  animation:glowPulse 3s ease-in-out infinite;
  border-radius:50%;
}
.brand-icon svg{
  width:100%;height:100%;
  filter:drop-shadow(0 0 30px rgba(200,164,90,.6));
  animation:glowPulse 3s ease-in-out infinite;
}

/* Sparkles decorativos */
.sparkle{
  position:absolute;
  width:4px;height:4px;
  background:var(--gold3);
  border-radius:50%;
  opacity:0;
}
.sparkle:nth-child(1){top:10%;left:20%;animation:sparkle 3s ease-in-out infinite 0s;}
.sparkle:nth-child(2){top:30%;right:15%;animation:sparkle 3s ease-in-out infinite 1s;}
.sparkle:nth-child(3){bottom:25%;left:25%;animation:sparkle 3s ease-in-out infinite 2s;}

.brand-name{
  font-family:'Playfair Display',serif;
  font-size:3.4rem;
  font-weight:900;
  color:var(--gold2);
  letter-spacing:.02em;
  line-height:1;
  margin-bottom:8px;
  background:linear-gradient(135deg, var(--gold) 0%, var(--gold3) 50%, var(--gold) 100%);
  background-size:200% auto;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  animation:shimmer 4s linear infinite;
}
.brand-tagline{
  font-size:.75rem;
  letter-spacing:.35em;
  text-transform:uppercase;
  color:var(--text3);
  font-weight:300;
  margin-bottom:44px;
  opacity:0;
  animation:slideInRight 0.8s ease forwards 0.3s;
}
.brand-divider{
  display:flex;align-items:center;gap:12px;
  width:100%;max-width:220px;
  margin-bottom:44px;
  opacity:0;
  animation:fadeScale 0.8s ease forwards 0.5s;
}
.brand-divider-line{
  flex:1;
  height:1px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent);
  position:relative;
  overflow:hidden;
}
.brand-divider-line::after{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(90deg,transparent,var(--gold3),transparent);
  animation:shimmer 2s linear infinite;
}
.brand-divider-gem{
  width:8px;height:8px;
  background:var(--gold);
  transform:rotate(45deg);
  box-shadow:0 0 10px var(--gold);
  animation:glowPulse 2s ease-in-out infinite;
}

/* Mensaje admin */
#admin-msg{
  display:none;
  background:linear-gradient(135deg,rgba(200,164,90,.12),rgba(200,164,90,.05));
  border:1px solid rgba(200,164,90,.25);
  border-radius:14px;
  padding:16px 20px;
  margin:0 0 32px;
  width:100%;max-width:360px;
  text-align:center;
  font-family:'Playfair Display',serif;
  font-size:1rem;
  font-style:italic;
  color:var(--cream2);
  line-height:1.6;
  position:relative;
  backdrop-filter:blur(10px);
  transform:translateY(10px);
  opacity:0;
  transition:all .4s ease;
}
#admin-msg.visible{
  display:block;
  transform:translateY(0);
  opacity:1;
  animation:pageEnter 0.5s ease;
}
#admin-msg::before{
  content:'✦';
  position:absolute;top:-10px;left:50%;transform:translateX(-50%);
  background:var(--bg);padding:0 12px;
  color:var(--gold);font-size:1.1rem;font-style:normal;
  animation:glowPulse 2s ease-in-out infinite;
}

/* Botones home mejorados */
.home-btns{
  display:flex;flex-direction:column;gap:14px;
  width:100%;max-width:360px;
}
.btn-nav{
  display:flex;align-items:center;gap:18px;
  padding:20px 24px;
  border-radius:16px;
  border:1px solid var(--border2);
  background:var(--surface);
  color:var(--text);
  cursor:pointer;
  font-family:'Outfit',sans-serif;
  font-size:1rem;
  font-weight:500;
  transition:all .3s cubic-bezier(.4,0,.2,1);
  text-align:left;
  position:relative;
  overflow:hidden;
  opacity:0;
  transform:translateY(20px);
}
.btn-nav:nth-child(1){animation:slideInRight 0.6s ease forwards 0.6s;}
.btn-nav:nth-child(2){animation:slideInRight 0.6s ease forwards 0.75s;}
.btn-nav:nth-child(3){animation:slideInRight 0.6s ease forwards 0.9s;}

.btn-nav::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,rgba(200,164,90,.1),transparent 60%);
  opacity:0;
  transition:opacity .3s;
}
.btn-nav:hover::before{
  opacity:1;
}
.btn-nav::after{
  content:'';
  position:absolute;
  top:50%;
  left:50%;
  width:0;
  height:0;
  background:rgba(200,164,90,.3);
  border-radius:50%;
  transform:translate(-50%,-50%);
  transition:width .6s,height .6s;
}
.btn-nav:active::after{
  width:300px;
  height:300px;
}
.btn-nav:hover{
  border-color:var(--gold);
  transform:translateY(-2px);
  box-shadow:0 10px 40px rgba(200,164,90,.15);
}
.btn-nav:active{
  transform:translateY(0) scale(.98);
}

.btn-nav-icon{
  width:48px;height:48px;
  border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  background:linear-gradient(135deg,var(--goldsoft),rgba(200,164,90,.05));
  color:var(--gold2);
  flex-shrink:0;
  transition:all .3s ease;
  position:relative;
  overflow:hidden;
}
.btn-nav:hover .btn-nav-icon{
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  color:var(--bg);
  transform:scale(1.1) rotate(5deg);
}
.btn-nav-icon svg{
  width:24px;height:24px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s ease;
}
.btn-nav:hover .btn-nav-icon svg{
  transform:scale(1.1);
}

.btn-nav-content{flex:1;}
.btn-nav-title{
  font-weight:600;
  color:var(--cream);
  font-size:1rem;
  transition:color .3s;
}
.btn-nav:hover .btn-nav-title{
  color:var(--gold3);
}
.btn-nav-sub{
  font-size:.78rem;
  color:var(--text3);
  margin-top:3px;
  transition:color .3s;
}
.btn-nav:hover .btn-nav-sub{
  color:var(--text2);
}

.btn-nav-arrow{
  color:var(--text3);
  transition:all .3s ease;
}
.btn-nav:hover .btn-nav-arrow{
  color:var(--gold);
  transform:translateX(4px);
}
.btn-nav-arrow svg{
  width:18px;height:18px;
  stroke:currentColor;
  stroke-width:2;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
}

/* WiFi dot mejorado */
.wifi-live{
  position:absolute;top:16px;right:16px;
  width:8px;height:8px;
  background:var(--green);
  border-radius:50%;
  box-shadow:0 0 12px rgba(26,102,64,.9), 0 0 20px rgba(26,102,64,.4);
  animation:pulse 2s infinite;
}
.wifi-live::before{
  content:'';
  position:absolute;
  inset:-4px;
  border:2px solid var(--green);
  border-radius:50%;
  opacity:0;
  animation:ripple 2s infinite;
}
@keyframes ripple{
  0%{transform:scale(1);opacity:1;}
  100%{transform:scale(2);opacity:0;}
}

/* Footer home */
.home-footer{
  padding:20px 32px calc(20px + var(--safe-bottom));
  text-align:center;
  opacity:0;
  animation:fadeScale 0.8s ease forwards 1.1s;
}
.home-footer a{
  font-size:.7rem;letter-spacing:.18em;text-transform:uppercase;
  color:var(--text3);text-decoration:none;
  display:inline-flex;align-items:center;gap:8px;
  transition:all .3s;
  padding:8px 16px;
  border-radius:20px;
}
.home-footer a:hover{
  color:var(--gold);
  background:rgba(200,164,90,.1);
}
.home-footer svg{
  width:14px;height:14px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s;
}
.home-footer a:hover svg{
  transform:translateY(-2px);
}

/* ════ INNER PAGES MEJORADAS ════ */
.page-header{
  display:flex;align-items:center;gap:14px;
  padding:18px 22px;
  background:rgba(10,8,6,.95);
  backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  flex-shrink:0;
  padding-top:calc(18px + env(safe-area-inset-top, 0px));
  position:relative;
  overflow:hidden;
}
.page-header::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:2px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent);
  opacity:0.5;
}
.btn-back{
  width:42px;height:42px;
  border-radius:12px;
  border:1px solid var(--border2);
  background:transparent;
  color:var(--text2);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  transition:all .3s ease;
  flex-shrink:0;
  position:relative;
  overflow:hidden;
}
.btn-back::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,var(--goldsoft),transparent);
  opacity:0;
  transition:opacity .3s;
}
.btn-back:hover{
  border-color:var(--gold);
  color:var(--gold);
  transform:translateX(-2px);
}
.btn-back:hover::before{
  opacity:1;
}
.btn-back:active{
  transform:scale(0.95);
}
.btn-back svg{
  width:22px;height:22px;
  stroke:currentColor;
  stroke-width:1.8;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s;
}
.btn-back:hover svg{
  transform:translateX(-3px);
}

.page-title{
  font-family:'Playfair Display',serif;
  font-size:1.35rem;
  font-weight:700;
  color:var(--gold2);
  background:linear-gradient(135deg,var(--gold),var(--gold3));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.page-sub{
  font-size:.72rem;
  color:var(--text3);
  margin-top:2px;
  letter-spacing:0.05em;
}

.page-body{
  flex:1;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
  padding-bottom:calc(24px + var(--safe-bottom));
}

/* ════ MENÚ MEJORADO ════ */
.cat-bar{
  display:flex;gap:10px;
  overflow-x:auto;
  padding:16px 18px 12px;
  scrollbar-width:none;
  border-bottom:1px solid var(--border);
  flex-shrink:0;
}
.cat-bar::-webkit-scrollbar{display:none;}
.cat-chip{
  display:inline-flex;align-items:center;gap:8px;
  padding:10px 18px;
  border-radius:100px;
  border:1px solid var(--border2);
  background:transparent;
  font-family:'Outfit',sans-serif;
  font-size:.8rem;font-weight:500;
  color:var(--text2);
  cursor:pointer;white-space:nowrap;
  transition:all .3s cubic-bezier(.4,0,.2,1);
  position:relative;
  overflow:hidden;
}
.cat-chip::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  opacity:0;
  transition:opacity .3s;
}
.cat-chip svg{
  width:16px;height:16px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  position:relative;
  z-index:1;
  transition:transform .3s;
}
.cat-chip span{position:relative;z-index:1;}
.cat-chip:hover{
  border-color:var(--gold);
  color:var(--gold);
  transform:translateY(-1px);
}
.cat-chip:hover svg{
  transform:scale(1.1) rotate(-5deg);
}
.cat-chip.active{
  background:transparent;
  border-color:var(--gold);
  color:var(--bg);
  font-weight:600;
  transform:scale(1.05);
  box-shadow:0 4px 20px rgba(200,164,90,.3);
}
.cat-chip.active::before{
  opacity:1;
}
.cat-chip.active svg{
  stroke:var(--bg);
  transform:scale(1.1);
}

#menu-body{padding:20px 18px;}
.menu-section-title{
  display:flex;align-items:center;gap:12px;
  font-family:'Playfair Display',serif;
  font-size:1.2rem;
  font-style:italic;
  color:var(--cream2);
  margin:12px 0 16px;
  opacity:0;
  animation:slideInRight 0.5s ease forwards;
}
.menu-section-title::after{
  content:'';
  flex:1;
  height:1px;
  background:linear-gradient(90deg,var(--border),var(--gold),var(--border));
  opacity:0.5;
}
.menu-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-bottom:28px;
}
.menu-card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:16px;
  padding:18px 14px;
  position:relative;
  overflow:hidden;
  transition:all .4s cubic-bezier(.4,0,.2,1);
  opacity:0;
  transform:translateY(20px);
  animation:fadeScale 0.5s ease forwards;
}
.menu-card:nth-child(1){animation-delay:0.1s;}
.menu-card:nth-child(2){animation-delay:0.2s;}
.menu-card:nth-child(3){animation-delay:0.3s;}
.menu-card:nth-child(4){animation-delay:0.4s;}

.menu-card::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:3px;
  background:linear-gradient(90deg,var(--gold),var(--gold2),var(--gold3));
  opacity:0;
  transition:opacity .3s;
}
.menu-card:hover{
  border-color:var(--gold);
  transform:translateY(-4px) scale(1.02);
  box-shadow:0 12px 40px rgba(200,164,90,.15);
}
.menu-card:hover::before{
  opacity:1;
}
.menu-card:active{
  transform:translateY(-2px) scale(0.98);
  transition:all .1s;
}
.menu-card-ico{
  width:44px;height:44px;
  background:linear-gradient(135deg,var(--goldsoft),rgba(200,164,90,.08));
  border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  margin-bottom:14px;
  color:var(--gold2);
  transition:all .3s ease;
}
.menu-card:hover .menu-card-ico{
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  color:var(--bg);
  transform:scale(1.1) rotate(5deg);
}
.menu-card-ico svg{
  width:22px;height:22px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s;
}
.menu-card:hover .menu-card-ico svg{
  transform:scale(1.2);
}
.menu-card-name{
  font-size:.95rem;
  font-weight:600;
  color:var(--text);
  line-height:1.3;
  margin-bottom:6px;
  transition:color .3s;
}
.menu-card:hover .menu-card-name{
  color:var(--gold3);
}
.menu-card-cat{
  font-size:.68rem;
  color:var(--text3);
  text-transform:uppercase;
  letter-spacing:.08em;
  margin-bottom:10px;
}
.menu-card-price{
  font-family:'Playfair Display',serif;
  font-size:1.15rem;
  font-weight:700;
  color:var(--gold);
  transition:all .3s;
}
.menu-card:hover .menu-card-price{
  color:var(--gold3);
  transform:scale(1.05);
}

/* ════ PEDIDO MEJORADO ════ */
#page-pedido .page-body{padding:24px 18px calc(24px + var(--safe-bottom));}

.mesa-card{
  background:linear-gradient(135deg,var(--surface),var(--surface2));
  border:1px solid var(--border);
  border-radius:20px;
  padding:28px 24px;
  margin-bottom:20px;
  text-align:center;
  position:relative;
  overflow:hidden;
  box-shadow:0 4px 30px rgba(0,0,0,.3);
}
.mesa-card::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:2px;
  background:linear-gradient(90deg,var(--gold),var(--gold2));
  opacity:0.6;
}
.mesa-card-label{
  font-size:.75rem;
  letter-spacing:.25em;
  text-transform:uppercase;
  color:var(--text3);
  margin-bottom:12px;
  font-weight:500;
}
.mesa-input-row{
  display:flex;
  gap:12px;
  max-width:280px;
  margin:0 auto;
}
.mesa-input{
  flex:1;
  padding:16px;
  border:2px solid var(--border2);
  border-radius:14px;
  background:var(--bg);
  color:var(--text);
  font-family:'Playfair Display',serif;
  font-size:2rem;
  font-weight:700;
  text-align:center;
  -moz-appearance:textfield;
  transition:all .3s ease;
  box-shadow:inset 0 2px 10px rgba(0,0,0,.3);
}
.mesa-input::-webkit-outer-spin-button,.mesa-input::-webkit-inner-spin-button{-webkit-appearance:none;}
.mesa-input:focus{
  outline:none;
  border-color:var(--gold);
  box-shadow:inset 0 2px 10px rgba(0,0,0,.3), 0 0 20px rgba(200,164,90,.2);
  transform:scale(1.02);
}
.mesa-input::placeholder{color:var(--text3);opacity:0.5;}
.btn-buscar{
  padding:16px 22px;
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  border:none;
  border-radius:14px;
  color:#0a0806;
  font-family:'Outfit',sans-serif;
  font-weight:700;
  font-size:1rem;
  cursor:pointer;
  white-space:nowrap;
  display:flex;
  align-items:center;
  gap:8px;
  transition:all .3s ease;
  box-shadow:0 4px 20px rgba(200,164,90,.3);
  position:relative;
  overflow:hidden;
}
.btn-buscar::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,transparent,rgba(255,255,255,.2),transparent);
  transform:translateX(-100%);
  transition:transform .6s;
}
.btn-buscar:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 30px rgba(200,164,90,.4);
}
.btn-buscar:hover::before{
  transform:translateX(100%);
}
.btn-buscar:active{
  transform:translateY(0) scale(0.98);
}
.btn-buscar svg{
  width:20px;height:20px;
  stroke:currentColor;
  stroke-width:2;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s;
}
.btn-buscar:hover svg{
  transform:scale(1.1);
}

.err-msg{
  font-size:.85rem;
  color:#ff6b6b;
  margin-top:14px;
  display:none;
  background:rgba(139,32,32,.15);
  border-radius:10px;
  padding:12px 16px;
  border:1px solid rgba(139,32,32,.3);
  animation:shake 0.5s ease;
}
@keyframes shake{
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-5px);}
  75%{transform:translateX(5px);}
}
.err-msg.show{display:block;}

/* Resultado pedido */
#pedido-result{display:none;}
#pedido-result.show{
  display:block;
  animation:pageEnter 0.5s ease;
}

.result-header{
  background:linear-gradient(135deg,var(--surface),var(--surface2));
  border:1px solid var(--border);
  border-radius:16px 16px 0 0;
  padding:20px 22px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom:none;
  position:relative;
}
.result-header::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:2px;
  background:linear-gradient(90deg,var(--gold),var(--gold2));
}
.result-mesa{
  font-family:'Playfair Display',serif;
  font-size:2.2rem;
  font-weight:900;
  color:var(--gold2);
  text-shadow:0 0 20px rgba(200,164,90,.3);
}
.result-mesa-lbl{
  font-size:.65rem;
  letter-spacing:.2em;
  text-transform:uppercase;
  color:var(--text3);
  font-weight:500;
}
.badge-activo{
  display:inline-flex;
  align-items:center;
  gap:6px;
  background:rgba(26,102,64,.25);
  border:1px solid rgba(26,102,64,.5);
  border-radius:100px;
  padding:6px 14px;
  font-size:.78rem;
  font-weight:600;
  color:#4ade80;
  box-shadow:0 0 20px rgba(26,102,64,.2);
}
.badge-dot{
  width:6px;
  height:6px;
  border-radius:50%;
  background:#4ade80;
  animation:pulse 1.5s infinite;
  box-shadow:0 0 10px #4ade80;
}

.result-meta{
  background:var(--surface2);
  border:1px solid var(--border);
  border-top:none;
  padding:14px 22px;
  display:flex;
  gap:20px;
  flex-wrap:wrap;
  border-bottom:none;
}
.result-meta-item{
  font-size:.8rem;
  color:var(--text2);
  display:flex;
  align-items:center;
  gap:6px;
}
.result-meta-item svg{
  width:15px;
  height:15px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
}
.result-meta-item strong{
  color:var(--text);
  font-weight:600;
}

.result-items{
  background:var(--surface);
  border:1px solid var(--border);
  border-top:none;
  border-radius:0 0 16px 16px;
  overflow:hidden;
  box-shadow:0 10px 40px rgba(0,0,0,.2);
}
.result-item{
  padding:16px 22px;
  display:grid;
  grid-template-columns:1fr auto auto;
  gap:14px;
  align-items:center;
  border-bottom:1px solid var(--border);
  transition:all .3s;
}
.result-item:hover{
  background:rgba(200,164,90,.05);
}
.result-item:last-child{border-bottom:none;}
.result-item-name{
  font-size:.95rem;
  font-weight:500;
  color:var(--text);
}
.result-item-cat{
  font-size:.68rem;
  color:var(--text3);
  margin-top:2px;
}
.result-item-qty{
  background:linear-gradient(135deg,var(--goldsoft),rgba(200,164,90,.1));
  border:1px solid rgba(200,164,90,.3);
  border-radius:8px;
  padding:6px 14px;
  font-family:'Playfair Display',serif;
  font-size:1.1rem;
  font-weight:700;
  color:var(--gold2);
  text-align:center;
  min-width:40px;
}
.result-item-sub{
  font-size:.95rem;
  font-weight:600;
  color:var(--text2);
  text-align:right;
  font-family:'Playfair Display',serif;
}
.result-total{
  background:linear-gradient(135deg,var(--bg),rgba(200,164,90,.05));
  padding:18px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-top:2px solid var(--border2);
  position:relative;
}
.result-total::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:1px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent);
  opacity:0.5;
}
.result-total-lbl{
  font-size:.75rem;
  letter-spacing:.15em;
  text-transform:uppercase;
  color:var(--text3);
  font-weight:500;
}
.result-total-amt{
  font-family:'Playfair Display',serif;
  font-size:1.9rem;
  font-weight:900;
  color:var(--gold);
  text-shadow:0 0 20px rgba(200,164,90,.3);
}

.timer-strip{
  background:linear-gradient(135deg,var(--surface2),var(--surface));
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px 22px;
  margin-top:16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 4px 20px rgba(0,0,0,.2);
}
.timer-lbl{
  font-size:.72rem;
  letter-spacing:.15em;
  text-transform:uppercase;
  color:var(--text3);
  font-weight:500;
}
.timer-val{
  font-family:'Playfair Display',serif;
  font-size:1.5rem;
  font-weight:700;
  color:var(--cream2);
  transition:color .3s;
}
.timer-val.alert{
  color:#ff6b6b;
  text-shadow:0 0 10px rgba(255,107,107,.5);
  animation:pulse 1s infinite;
}
.timer-ico{
  color:var(--gold);
  opacity:.6;
}
.timer-ico svg{
  width:32px;
  height:32px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  animation:float 3s ease-in-out infinite;
}

.empty-state{
  text-align:center;
  padding:56px 24px;
  background:linear-gradient(135deg,var(--surface),var(--surface2));
  border:1px solid var(--border);
  border-radius:18px;
  box-shadow:0 4px 30px rgba(0,0,0,.2);
}
.empty-ico{
  color:var(--gold);
  opacity:.4;
  margin-bottom:16px;
  display:flex;
  justify-content:center;
}
.empty-ico svg{
  width:56px;
  height:56px;
  stroke:currentColor;
  stroke-width:1.2;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  animation:float 4s ease-in-out infinite;
}
.empty-txt{
  font-size:.95rem;
  color:var(--text3);
  line-height:1.5;
}
.empty-txt strong{
  color:var(--text2);
  display:block;
  margin-bottom:6px;
  font-size:1.1rem;
  font-weight:600;
}

.qr-chip{
  display:inline-flex;
  align-items:center;
  gap:8px;
  background:linear-gradient(135deg,rgba(200,164,90,.15),rgba(200,164,90,.05));
  border:1px solid rgba(200,164,90,.3);
  border-radius:100px;
  padding:8px 16px;
  font-size:.8rem;
  color:var(--gold2);
  margin-bottom:16px;
  font-weight:500;
  animation:fadeScale 0.5s ease;
}
.qr-chip svg{
  width:16px;
  height:16px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
}

/* ════ MODAL WIFI MEJORADO ════ */
.modal-overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  backdrop-filter:blur(20px);
  display:none;
  align-items:flex-end;
  justify-content:center;
  z-index:100;
  opacity:0;
  transition:opacity .3s ease;
}
.modal-overlay.open{
  display:flex;
  opacity:1;
}
.modal-sheet{
  background:linear-gradient(180deg,var(--surface),var(--bg));
  border:1px solid var(--border);
  border-radius:28px 28px 0 0;
  width:100%;
  max-width:520px;
  padding:0 0 calc(28px + var(--safe-bottom));
  transform:translateY(100%);
  transition:transform .4s cubic-bezier(.4,0,.2,1);
  box-shadow:0 -10px 60px rgba(0,0,0,.5);
}
.modal-overlay.open .modal-sheet{
  transform:translateY(0);
}
.modal-drag{
  width:44px;
  height:5px;
  background:var(--border2);
  border-radius:3px;
  margin:16px auto 24px;
  position:relative;
}
.modal-drag::before{
  content:'';
  position:absolute;
  inset:-10px;
}
.modal-head{
  padding:0 26px 20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom:1px solid var(--border);
}
.modal-title{
  font-family:'Playfair Display',serif;
  font-size:1.35rem;
  color:var(--gold2);
  display:flex;
  align-items:center;
  gap:12px;
}
.modal-title svg{
  width:26px;
  height:26px;
  stroke:currentColor;
  stroke-width:1.5;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  filter:drop-shadow(0 0 10px rgba(200,164,90,.5));
}
.modal-close-btn{
  width:40px;
  height:40px;
  border:1px solid var(--border2);
  background:transparent;
  border-radius:12px;
  color:var(--text2);
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all .3s;
}
.modal-close-btn:hover{
  border-color:var(--gold);
  color:var(--gold);
  transform:rotate(90deg);
}
.modal-close-btn svg{
  width:18px;
  height:18px;
  stroke:currentColor;
  stroke-width:2;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
}
.modal-body{
  padding:24px 26px 0;
}
.wifi-row{
  background:var(--bg);
  border:1px solid var(--border2);
  border-radius:14px;
  padding:18px 20px;
  margin-bottom:14px;
  transition:all .3s;
}
.wifi-row:hover{
  border-color:var(--gold);
  transform:translateX(4px);
}
.wifi-row-label{
  font-size:.72rem;
  letter-spacing:.18em;
  text-transform:uppercase;
  color:var(--text3);
  margin-bottom:6px;
  font-weight:500;
}
.wifi-row-value{
  font-family:'Playfair Display',serif;
  font-size:1.5rem;
  font-weight:700;
  color:var(--cream);
  letter-spacing:0.02em;
}
.wifi-hint{
  font-size:.85rem;
  color:var(--text2);
  line-height:1.6;
  padding:16px 18px;
  background:linear-gradient(135deg,rgba(200,164,90,.08),rgba(200,164,90,.02));
  border-radius:12px;
  border-left:4px solid var(--gold);
  margin-bottom:18px;
}
.btn-copy-pass{
  width:100%;
  padding:18px;
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  border:none;
  border-radius:14px;
  color:#0a0806;
  font-family:'Outfit',sans-serif;
  font-weight:700;
  font-size:1rem;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  cursor:pointer;
  transition:all .3s;
  box-shadow:0 4px 20px rgba(200,164,90,.3);
  position:relative;
  overflow:hidden;
}
.btn-copy-pass::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,transparent,rgba(255,255,255,.3),transparent);
  transform:translateX(-100%);
  transition:transform .6s;
}
.btn-copy-pass:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 30px rgba(200,164,90,.4);
}
.btn-copy-pass:hover::before{
  transform:translateX(100%);
}
.btn-copy-pass:active{
  transform:translateY(0) scale(0.98);
}
.btn-copy-pass svg{
  width:20px;
  height:20px;
  stroke:currentColor;
  stroke-width:2;
  fill:none;
  stroke-linecap:round;
  stroke-linejoin:round;
  transition:transform .3s;
}
.btn-copy-pass:hover svg{
  transform:scale(1.1);
}

/* ════ TOAST MEJORADO ════ */
.toast{
  position:fixed;
  bottom:calc(28px + var(--safe-bottom));
  left:50%;
  transform:translateX(-50%) translateY(20px);
  background:linear-gradient(135deg,var(--surface2),var(--surface));
  border:1px solid var(--gold);
  color:var(--gold3);
  padding:14px 24px;
  border-radius:100px;
  font-size:.9rem;
  font-weight:500;
  z-index:999;
  white-space:nowrap;
  opacity:0;
  animation:toastIn .4s ease forwards;
  box-shadow:0 10px 40px rgba(0,0,0,.4), 0 0 20px rgba(200,164,90,.2);
}
@keyframes toastIn{
  to{
    opacity:1;
    transform:translateX(-50%) translateY(0);
  }
}

/* Loading animation */
.loading-shimmer{
  background:linear-gradient(90deg,var(--surface) 25%,var(--surface2) 50%,var(--surface) 75%);
  background-size:200% 100%;
  animation:shimmer 1.5s infinite;
  border-radius:8px;
}
</style>
</head>
<body>

<!-- ══════════════ HOME ══════════════ -->
<div id="page-home" class="page active">
  <div class="home-top">

    <!-- Icono principal mejorado con animaciones -->
    <div class="brand-icon">
      <div class="sparkle"></div>
      <div class="sparkle"></div>
      <div class="sparkle"></div>
      <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <radialGradient id="glow" cx="50%" cy="30%" r="70%">
            <stop offset="0%" stop-color="#f0d48a" stop-opacity="1"/>
            <stop offset="50%" stop-color="#ddb96a" stop-opacity=".8"/>
            <stop offset="100%" stop-color="#c8a45a" stop-opacity=".4"/>
          </radialGradient>
          <linearGradient id="liquid" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#f0d48a" stop-opacity=".9"/>
            <stop offset="100%" stop-color="#c8a45a" stop-opacity=".6"/>
          </linearGradient>
          <filter id="glow-filter" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>
        
        <!-- Halo exterior pulsante -->
        <circle cx="50" cy="50" r="45" fill="none" stroke="url(#glow)" stroke-width="0.5" opacity="0.3">
          <animate attributeName="r" values="45;48;45" dur="3s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.3;0.1;0.3" dur="3s" repeatCount="indefinite"/>
        </circle>
        
        <!-- Copa de vino mejorada -->
        <g filter="url(#glow-filter)">
          <!-- Líquido animado -->
          <path fill="url(#liquid)" opacity="0.9">
            <animate attributeName="d" 
              values="M32 15 Q28 35 36 45 Q42 52 50 53 Q58 52 64 45 Q72 35 68 15 Z;
                      M32 15 Q29 36 37 46 Q43 53 50 54 Q57 53 63 46 Q71 36 68 15 Z;
                      M32 15 Q28 35 36 45 Q42 52 50 53 Q58 52 64 45 Q72 35 68 15 Z"
              dur="4s" repeatCount="indefinite"/>
          </path>
          
          <!-- Reflejo dinámico -->
          <path d="M38 20 Q36 30 40 38 Q43 43 45 44" stroke="rgba(255,255,255,.5)" stroke-width="2" stroke-linecap="round" fill="none">
            <animate attributeName="opacity" values="0.5;0.8;0.5" dur="3s" repeatCount="indefinite"/>
          </path>
          
          <!-- Brillo superior -->
          <ellipse cx="42" cy="25" rx="3" ry="5" fill="rgba(255,255,255,.4)">
            <animate attributeName="opacity" values="0.4;0.7;0.4" dur="2s" repeatCount="indefinite"/>
          </ellipse>
        </g>
        
        <!-- Pie de copa -->
        <line x1="50" y1="53" x2="50" y2="75" stroke="url(#glow)" stroke-width="4" stroke-linecap="round" filter="url(#glow-filter)"/>
        
        <!-- Base de copa -->
        <path d="M35 75 Q50 71 65 75" stroke="url(#glow)" stroke-width="4" stroke-linecap="round" fill="none" filter="url(#glow-filter)"/>
        
        <!-- Tenedor animado izquierda -->
        <g opacity="0.8">
          <path d="M18 18 L18 40 M14 18 L14 30 M22 18 L22 30 M14 30 Q18 35 22 30" 
                stroke="#c8a45a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none">
            <animateTransform attributeName="transform" type="rotate" values="0 18 30; -3 18 30; 0 18 30" dur="4s" repeatCount="indefinite"/>
          </path>
        </g>
        
        <!-- Cuchillo animado derecha -->
        <g opacity="0.8">
          <path d="M82 18 L82 40 M82 18 Q87 23 85 30 Q82 33 82 35" 
                stroke="#c8a45a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none">
            <animateTransform attributeName="transform" type="rotate" values="0 82 30; 3 82 30; 0 82 30" dur="4s" repeatCount="indefinite"/>
          </path>
        </g>
        
        <!-- Destellos -->
        <circle cx="25" cy="25" r="1.5" fill="#f0d48a" opacity="0">
          <animate attributeName="opacity" values="0;1;0" dur="3s" repeatCount="indefinite" begin="0s"/>
        </circle>
        <circle cx="75" cy="35" r="1" fill="#f0d48a" opacity="0">
          <animate attributeName="opacity" values="0;1;0" dur="3s" repeatCount="indefinite" begin="1s"/>
        </circle>
        <circle cx="50" cy="10" r="1" fill="#f0d48a" opacity="0">
          <animate attributeName="opacity" values="0;1;0" dur="3s" repeatCount="indefinite" begin="2s"/>
        </circle>
      </svg>
    </div>

    <div class="brand-name">Delicias</div>
    <div class="brand-tagline">Restaurante</div>

    <div class="brand-divider">
      <div class="brand-divider-line"></div>
      <div class="brand-divider-gem"></div>
      <div class="brand-divider-line"></div>
    </div>

    <div id="admin-msg"><span id="admin-msg-text"></span></div>

    <div class="home-btns">

      <button class="btn-nav" onclick="irA('menu')">
        <div class="btn-nav-icon">
          <svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/><path d="M8 7h8"/><path d="M8 11h5"/></svg>
        </div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">Ver Menú</div>
          <div class="btn-nav-sub">Platos, bebidas y postres</div>
        </div>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>

      <button class="btn-nav" onclick="irA('pedido')">
        <div class="btn-nav-icon">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        </div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">Consultar Pedido</div>
          <div class="btn-nav-sub">Ver tu mesa en tiempo real</div>
        </div>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>

      <button class="btn-nav" onclick="abrirWifi()">
        <div class="btn-nav-icon">
          <svg viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1" fill="currentColor" stroke="none"/></svg>
        </div>
        <div class="btn-nav-content">
          <div class="btn-nav-title">WiFi Gratis</div>
          <div class="btn-nav-sub" id="wifi-sub-txt">Red disponible</div>
        </div>
        <span class="wifi-live"></span>
        <div class="btn-nav-arrow"><svg viewBox="0 0 24 24"><path d="m9 18 6-6-6-6"/></svg></div>
      </button>

    </div>
  </div>

  <div class="home-footer">
    <a href="admin.html">
      Acceso personal
      <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
    </a>
  </div>
</div>

<!-- ══════════════ MENÚ ══════════════ -->
<div id="page-menu" class="page">
  <div class="page-header">
    <button class="btn-back" onclick="irAtras()">
      <svg viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <div>
      <div class="page-title">Nuestro Menú</div>
      <div class="page-sub" id="menu-sub">Cargando...</div>
    </div>
  </div>

  <div class="cat-bar">
    <button class="cat-chip active" data-cat="todos" onclick="filtrarCat('todos',this)">
      <svg viewBox="0 0 24 24"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3v7"/></svg>
      Todos
    </button>
    <button class="cat-chip" data-cat="comida" onclick="filtrarCat('comida',this)">
      <svg viewBox="0 0 24 24"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3v7"/></svg>
      Comidas
    </button>
    <button class="cat-chip" data-cat="bebida" onclick="filtrarCat('bebida',this)">
      <svg viewBox="0 0 24 24"><path d="m19 3-7 8-7-8Z"/><path d="M8 22h8"/><path d="M12 11v11"/></svg>
      Bebidas
    </button>
    <button class="cat-chip" data-cat="postre" onclick="filtrarCat('postre',this)">
      <svg viewBox="0 0 24 24"><path d="M12 2a5 5 0 0 0-5 5c0 2 1 3.5 2.5 4.5M12 2a5 5 0 0 1 5 5c0 2-1 3.5-2.5 4.5M5 11h14M5 11c0 5 3 8 7 9 4-1 7-4 7-9M9 22h6"/></svg>
      Postres
    </button>
  </div>

  <div class="page-body">
    <div id="menu-body"></div>
  </div>
</div>

<!-- ══════════════ PEDIDO ══════════════ -->
<div id="page-pedido" class="page">
  <div class="page-header">
    <button class="btn-back" onclick="irAtras()">
      <svg viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <div>
      <div class="page-title">Consultar Pedido</div>
      <div class="page-sub">Tu mesa en tiempo real</div>
    </div>
  </div>

  <div class="page-body">
    <div id="qr-chip-wrap" style="text-align:center;padding:18px 0 0;display:none;">
      <span class="qr-chip">
        <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>
        Mesa detectada por QR
      </span>
    </div>

    <div class="mesa-card">
      <div class="mesa-card-label">Número de mesa</div>
      <div class="mesa-input-row">
        <input class="mesa-input" type="number" id="inp-mesa"
          min="1" max="12" placeholder="—" inputmode="numeric"
          onkeydown="if(event.key==='Enter')buscarPedido()"/>
        <button class="btn-buscar" onclick="buscarPedido()">
          <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
          Buscar
        </button>
      </div>
      <div class="err-msg" id="err-pedido"></div>
    </div>

    <div id="pedido-result"></div>
    <div id="timer-strip" class="timer-strip" style="display:none;">
      <div>
        <div class="timer-lbl">Tiempo en mesa</div>
        <div class="timer-val" id="timer-val">—</div>
      </div>
      <div class="timer-ico"><svg viewBox="0 0 24 24"><path d="M10 2h4"/><path d="M12 14v-4"/><circle cx="12" cy="14" r="8"/></svg></div>
    </div>
  </div>
</div>

<!-- ══════════════ MODAL WIFI ══════════════ -->
<div class="modal-overlay" id="modal-wifi" onclick="if(event.target===this)cerrarWifi()">
  <div class="modal-sheet">
    <div class="modal-drag"></div>
    <div class="modal-head">
      <div class="modal-title">
        <svg viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><circle cx="12" cy="20" r="1" fill="currentColor" stroke="none"/></svg>
        WiFi Gratis
      </div>
      <button class="modal-close-btn" onclick="cerrarWifi()">
        <svg viewBox="0 0 24 24"><path d="M18 6 6 18m0-12 12 12"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="wifi-row">
        <div class="wifi-row-label">Red (SSID)</div>
        <div class="wifi-row-value" id="wifi-ssid">—</div>
      </div>
      <div class="wifi-row">
        <div class="wifi-row-label">Contraseña</div>
        <div class="wifi-row-value" id="wifi-pass">—</div>
      </div>
      <div class="wifi-hint">
        Abrí WiFi en tu dispositivo, seleccioná la red y usá la contraseña de arriba. Tocá el botón para copiarla.
      </div>
      <button class="btn-copy-pass" onclick="copiarPass()">
        <svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        Copiar Contraseña
      </button>
    </div>
  </div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp }  from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const FC = {
  apiKey:"AIzaSyCdKSf2g1cIyXrD6k_u1aR9TMln9HaPJro",
  authDomain:"delicia-restaurante.firebaseapp.com",
  databaseURL:"https://delicia-restaurante-default-rtdb.firebaseio.com",
  projectId:"delicia-restaurante",
  storageBucket:"delicia-restaurante.firebasestorage.app",
  messagingSenderId:"653903447900",
  appId:"1:653903447900:web:85cffda9d703e464af6399"
};

const TZ   = 'America/Asuncion';
const FMT  = n => 'Gs. ' + Math.round(n).toLocaleString('es-PY');
const $    = id => document.getElementById(id);

const CAT_NAMES = { comida:'Comidas', bebida:'Bebidas', postre:'Postres' };
const CAT_ORDER = ['comida','bebida','postre'];
const CAT_ICO = {
  comida:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3v7"/></svg>`,
  bebida:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m19 3-7 8-7-8Z"/><path d="M8 22h8"/><path d="M12 11v11"/></svg>`,
  postre:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a5 5 0 0 0-5 5c0 2 1 3.5 2.5 4.5M12 2a5 5 0 0 1 5 5c0 2-1 3.5-2.5 4.5M5 11h14M5 11c0 5 3 8 7 9 4-1 7-4 7-9M9 22h6"/></svg>`
};

let productos = [], mesas = {}, catActiva = 'todos';
let timerInt = null, tsActual = null, mesaActual = null;
let pageStack = [];

const db = getDatabase(initializeApp(FC));

/* ── Normalizar mesas ── */
function normMesas(raw) {
  if (!raw) return {};
  const n = {};
  if (Array.isArray(raw)) { raw.forEach((m,i) => { if(m) n[i+1]=m; }); }
  else Object.entries(raw).forEach(([k,v]) => {
    if (!v) return;
    const num = k.startsWith('mesa_') ? parseInt(k.slice(5)) : parseInt(k);
    if (!isNaN(num)) n[num] = v;
  });
  return n;
}

/* ── Firebase listeners ── */
onValue(ref(db,'config/publico'), snap => {
  if (!snap.exists()) return;
  const c = snap.val();
  if (c.wifi) {
    $('wifi-ssid').textContent = c.wifi.ssid || '—';
    $('wifi-pass').textContent = c.wifi.pass || '—';
    $('wifi-sub-txt').textContent = c.wifi.ssid || 'Red disponible';
  }
  if (c.mensaje?.visible && c.mensaje?.texto) {
    $('admin-msg-text').textContent = c.mensaje.texto;
    $('admin-msg').classList.add('visible');
  } else {
    $('admin-msg').classList.remove('visible');
  }
});

onValue(ref(db,'productos'), snap => {
  const r = snap.val();
  productos = r ? (Array.isArray(r) ? r : Object.values(r)).filter(Boolean) : [];
  renderMenu();
  if (mesaActual) renderPedido(mesaActual, false);
});

onValue(ref(db,'mesas'), snap => {
  mesas = normMesas(snap.val());
  if (mesaActual) renderPedido(mesaActual, false);
});

/* ── Navegación mejorada ── */
window.irA = function(pageId) {
  const cur = pageStack.length ? $('page-' + pageStack[pageStack.length-1]) : $('page-home');
  cur.classList.add('behind');
  cur.classList.remove('active');
  pageStack.push(pageId);
  const next = $('page-' + pageId);
  next.classList.add('active');
  next.classList.remove('behind');
  
  // Animar entrada de elementos
  setTimeout(() => {
    const cards = next.querySelectorAll('.menu-card, .result-item');
    cards.forEach((card, i) => {
      card.style.animationDelay = `${i * 0.1}s`;
      card.classList.add('animate-in');
    });
  }, 100);
};

window.irAtras = function() {
  if (!pageStack.length) return;
  const cur = $('page-' + pageStack.pop());
  cur.classList.remove('active');
  const prev = pageStack.length ? $('page-' + pageStack[pageStack.length-1]) : $('page-home');
  prev.classList.remove('behind');
  prev.classList.add('active');
  if (!pageStack.includes('pedido')) {
    if (timerInt) { clearInterval(timerInt); timerInt = null; }
    mesaActual = null; tsActual = null;
    $('timer-strip').style.display = 'none';
    $('pedido-result').innerHTML = '';
    $('pedido-result').classList.remove('show');
    $('err-pedido').classList.remove('show');
    $('inp-mesa').value = '';
  }
};

/* ── WiFi ── */
window.abrirWifi = () => {
  $('modal-wifi').classList.add('open');
  document.body.style.overflow = 'hidden';
};
window.cerrarWifi = () => {
  $('modal-wifi').classList.remove('open');
  document.body.style.overflow = '';
};
window.copiarPass = () => {
  const p = $('wifi-pass').textContent;
  navigator.clipboard?.writeText(p).then(() => toast('✓ Contraseña copiada')).catch(() => {
    const i = document.createElement('input');
    i.value = p; document.body.appendChild(i); i.select();
    document.execCommand('copy'); i.remove();
    toast('✓ Contraseña copiada');
  });
};

/* ── Render menú ── */
function renderMenu() {
  const count = productos.length;
  $('menu-sub').textContent = count + ' producto' + (count !== 1 ? 's' : '');
  renderMenuFiltrado();
}

function renderMenuFiltrado() {
  const body = $('menu-body');
  if (!productos.length) {
    body.innerHTML = '<div style="text-align:center;padding:56px;color:var(--text3);font-size:1rem;">Sin productos disponibles.</div>';
    return;
  }
  const cats = catActiva === 'todos' ? CAT_ORDER : [catActiva];
  let html = '';
  cats.forEach((c, catIndex) => {
    const items = productos.filter(p => (p.cat||'comida') === c);
    if (!items.length) return;
    html += `<div class="menu-section-title" style="animation-delay:${catIndex * 0.1}s">${CAT_NAMES[c]}</div>
    <div class="menu-grid">
      ${items.map((p, i) => `
        <div class="menu-card" style="animation-delay:${(catIndex * 0.1) + (i * 0.05)}s">
          <div class="menu-card-ico">${CAT_ICO[p.cat||'comida']}</div>
          <div class="menu-card-name">${p.nombre}</div>
          <div class="menu-card-cat">${CAT_NAMES[p.cat||'comida']}</div>
          <div class="menu-card-price">${FMT(p.precio)}</div>
        </div>`).join('')}
    </div>`;
  });
  body.innerHTML = html || '<div style="text-align:center;padding:56px;color:var(--text3);font-size:1rem;">Sin productos en esta categoría.</div>';
}

window.filtrarCat = function(cat, el) {
  catActiva = cat;
  document.querySelectorAll('.cat-chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  
  // Animar transición
  const body = $('menu-body');
  body.style.opacity = '0';
  body.style.transform = 'translateY(10px)';
  body.style.transition = 'all 0.3s ease';
  
  setTimeout(() => {
    renderMenuFiltrado();
    body.style.opacity = '1';
    body.style.transform = 'translateY(0)';
  }, 300);
};

/* ── Consultar pedido ── */
window.buscarPedido = function() {
  const num   = parseInt($('inp-mesa').value);
  const errEl = $('err-pedido');
  errEl.classList.remove('show');
  if (isNaN(num) || num < 1 || num > 12) {
    errEl.textContent = 'Ingresá un número de mesa válido (1 al 12).';
    errEl.classList.add('show');
    return;
  }
  mesaActual = num;
  renderPedido(num, true);
};

function renderPedido(num, animate) {
  const mesa  = mesas[num];
  const res   = $('pedido-result');
  const strip = $('timer-strip');

  if (!mesa?.ocupada) {
    res.innerHTML = `<div class="empty-state">
      <div class="empty-ico"><svg viewBox="0 0 24 24"><path d="M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3"/><path d="M3 11v5a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1z"/><path d="M5 18v2"/><path d="M19 18v2"/></svg></div>
      <div class="empty-txt"><strong>Mesa ${num} sin pedido activo</strong>Esta mesa está libre o aún no tiene pedidos registrados.</div>
    </div>`;
    res.classList.add('show');
    strip.style.display = 'none';
    if (timerInt) { clearInterval(timerInt); timerInt = null; }
    tsActual = null;
    return;
  }

  tsActual = mesa.tsOcupada || null;
  const pedido = mesa.pedidoActual || {};
  const items  = Object.entries(pedido).map(([pid,qty]) => {
    const p = productos.find(p => String(p.id) === String(pid));
    return (p && qty > 0) ? { ...p, qty, sub: p.precio * qty } : null;
  }).filter(Boolean);
  const total = items.reduce((s,i) => s + i.sub, 0);

  if (!items.length) {
    res.innerHTML = `<div class="empty-state"><div class="empty-ico"><svg viewBox="0 0 24 24"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3v7"/></svg></div><div class="empty-txt"><strong>Mesa ${num} ocupada</strong>Aún no tiene productos registrados.</div></div>`;
    res.classList.add('show');
    strip.style.display = 'none';
    return;
  }

  const desdeTxt = tsActual
    ? new Date(tsActual).toLocaleTimeString('es-PY',{hour:'2-digit',minute:'2-digit',timeZone:TZ})
    : '—';

  res.innerHTML = `
    <div class="result-header">
      <div><div class="result-mesa-lbl">Mesa</div><div class="result-mesa">${num}</div></div>
      <div class="badge-activo"><span class="badge-dot"></span>Activo</div>
    </div>
    <div class="result-meta">
      ${mesa.mesero ? `<span class="result-meta-item"><svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></svg><strong>${mesa.mesero}</strong></span>` : ''}
      <span class="result-meta-item"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>Desde <strong>${desdeTxt}</strong></span>
    </div>
    <div class="result-items">
      ${items.map((i, idx) => `
        <div class="result-item" style="animation-delay:${idx * 0.05}s">
          <div><div class="result-item-name">${i.nombre}</div><div class="result-item-cat">${CAT_NAMES[i.cat||'comida']}</div></div>
          <div class="result-item-qty">${i.qty}</div>
          <div class="result-item-sub">${FMT(i.sub)}</div>
        </div>`).join('')}
      <div class="result-total">
        <span class="result-total-lbl">Total</span>
        <span class="result-total-amt">${FMT(total)}</span>
      </div>
    </div>`;

  res.classList.add('show');
  $('err-pedido').classList.remove('show');

  strip.style.display = 'flex';
  if (timerInt) clearInterval(timerInt);
  function tick() {
    if (!tsActual) { $('timer-val').textContent = '—'; return; }
    const d = Math.floor((Date.now() - tsActual) / 1000);
    const h = Math.floor(d/3600), m = Math.floor((d%3600)/60), s = d%60;
    $('timer-val').textContent = h > 0
      ? `${h}h ${String(m).padStart(2,'0')}m ${String(s).padStart(2,'0')}s`
      : `${String(m).padStart(2,'0')}m ${String(s).padStart(2,'0')}s`;
    $('timer-val').className = 'timer-val' + (d >= 5400 ? ' alert' : '');
  }
  tick();
  timerInt = setInterval(tick, 1000);
}

/* ── QR ── */
const mesaQR = new URLSearchParams(location.search).get('mesa');
if (mesaQR && +mesaQR >= 1 && +mesaQR <= 12) {
  irA('pedido');
  $('inp-mesa').value = parseInt(mesaQR);
  $('qr-chip-wrap').style.display = 'block';
  mesaActual = parseInt(mesaQR);
  setTimeout(() => buscarPedido(), 1500);
}

/* ── Toast ── */
function toast(msg) {
  const el = document.createElement('div');
  el.className = 'toast'; 
  el.textContent = msg;
  document.body.appendChild(el);
  setTimeout(() => {
    el.style.opacity = '0';
    el.style.transform = 'translateX(-50%) translateY(20px)';
    setTimeout(() => el.remove(), 300);
  }, 2800);
}
</script>
</body>
</html>
